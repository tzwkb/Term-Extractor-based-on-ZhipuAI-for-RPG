# RPG游戏术语提取器

这是一个专门用于从RPG游戏文本中提取专业术语和专有名词的工具，基于智谱AI大语言模型API。它能够自动识别并提取各类游戏术语，如技能名称、职业名称、物品名称、地名、角色名和怪物名等。

## 功能特点

- **批量处理**：支持Excel和CSV文件的批量处理
- **智能识别**：自动识别ID列和文本列
- **术语提取**：提取RPG游戏文本中的专业术语和专有名词
- **术语分类**：为每个术语提供类型信息
- **数据清洗**：内置强大的文本清洗功能，可以清除HTML标签、超链接、特殊标记等
- **单列文件处理**：可以处理只有一列的Excel文件，自动创建虚拟ID
- **智能去重**：支持去除重复内容
- **友好界面**：提供图形用户界面，操作简单直观

## 安装要求

- Python 3.8 或更高版本
- 依赖库：pandas, xlsxwriter, requests, zhipuai

### 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 图形界面模式

运行以下命令启动图形界面：

```bash
python term_extractor_gui.py
```

在图形界面中：
1. 点击"选择文件"按钮选择输入Excel文件
2. 设置智谱API密钥（如果尚未配置）
3. 选择输出目录（可选）
4. 点击"数据清洗"按钮进行数据预处理（可选）
5. 点击"开始提取"按钮开始术语提取

### 命令行模式

```bash
python term_extractor.py --input <输入文件路径> --output <输出文件路径> --api-key <智谱API密钥>
```

## 数据清洗功能

数据清洗模块可以：

- 清除HTML标签
- 清除超链接
- 清除Markdown格式链接
- 清除数字
- 清除标点符号
- 清除游戏特有的格式标记
- 清除多余空格
- 去除重复内容

## 术语提取示例

原始文本：
```
玩家可以使用火球术对敌人造成50点伤害，或者使用治疗术恢复100点生命值。
```

提取结果：
```json
{
  "terms": [
    {
      "term": "火球术",
      "type": "技能",
      "context": "玩家可以使用火球术对敌人造成50点伤害"
    },
    {
      "term": "治疗术",
      "type": "技能",
      "context": "使用治疗术恢复100点生命值"
    }
  ]
}
```

## 文件格式

支持的输入文件格式：
- Excel文件（.xlsx, .xls）
- CSV文件（.csv）

输入文件可以有以下格式：
1. **双列格式**：一列为ID，一列为文本内容
2. **单列格式**：只有文本内容，程序会自动生成ID

## 配置

可以通过`config.json`文件进行基本配置：

```json
{
  "API_KEY": "您的智谱API密钥",
  "output_dir": "results"
}
```

## 已知问题和注意事项

- 处理大文件时可能需要较长时间
- API调用受智谱AI配额限制
- 确保输入文件中的文本内容充分，以获得更好的提取效果

## 许可证

本项目采用Apache License 2.0许可证

## 联系方式

如有问题或建议，请提交问题报告。 
